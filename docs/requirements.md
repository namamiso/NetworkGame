# ネットワーク学習ゲーム - 要件定義書（アルファ版）

## 1. はじめに
本ドキュメントは、HTML、CSS、JavaScript を用いて開発されるネットワーク学習ゲーム「ネットワーク学習ゲーム」のアルファ版における要件を定義します。ユーザーがゲームを通じて、ネットワークの基礎概念を視覚的・体験的に学習できることを目的とします。

この要件定義書は、開発チーム内での認識合わせと、今後の開発ロードマップの基礎となることを意図しています。

## 2. 目的
- **学習体験の提供**: ネットワークの基本的な概念（IPアドレス、ルーター、サブネットなど）を、堅苦しい座学ではなく、ゲーム形式で楽しみながら習得できる機会を提供します。
- **直感的理解の促進**: 複雑なネットワークの仕組みを、視覚的要素とインタラクティブな操作を通じて直感的に理解できるよう支援します。
- **将来的な拡張性**: 今後のステージ追加や、より高度なネットワーク概念の導入に向けた、堅牢かつ拡張性の高いゲームアーキテクチャの基盤を確立します。

## 3. ターゲットユーザー
- **情報系学習の初心者**: ネットワークに関する事前知識がほとんどない、高校生・専門学校生・大学生。
- **非エンジニアのビジネスパーソン**: 業務でネットワークに触れる機会があるが、専門的な知識は不足している人。
- **ゲームを通じて学びたい人**: 楽しみながら新しい知識を習得したいという学習意欲のある人。

## 4. 機能要件
ユーザーが直接操作する、またはゲームが提供する具体的な機能について記述します。

### 4.1. 共通画面機能

#### 4.1.1. メインメニュー画面 (#menu-screen)

**表示要素:**
- ゲームタイトル: ネットワーク学習ゲーム が中央に大きく表示されること。
- メニューボタン:
  - ゲーム開始 ボタン: ステージ選択画面 (#stage-select-screen) へ遷移する。
  - 設定 ボタン: 設定画面 (#settings-screen) へ遷移する。
  - クレジット ボタン: クレジット情報を表示するポップアップ（alert）が表示される。
  - 終了 ボタン: ゲームを終了する確認ダイアログ（confirm）の後、ウィンドウを閉じる。
- バージョン情報: アルファ版 v0.1 が画面下部に表示されること。
- 初期状態: アプリ起動時にデフォルトで表示される画面であること。

#### 4.1.2. ステージ選択画面 (#stage-select-screen)

**表示要素:**
- 画面タイトル: ステージ選択 が表示されること。
- ステージカード（チュートリアル、ステージ1〜3）:
  - 各カードにステージ番号とタイトル（例: チュートリアル、ステージ 1: ネットワーク基礎）が表示されること。
  - 各カードにステージの簡単な説明（例: ドラッグ&ドロップの操作方法を覚えよう！）が表示されること。
  - 各カードに現在のステータス（▶ プレイ可能、🔒 ロック中、✅ クリア済み）が表示されること。
- メインメニューに戻る ボタン: メインメニュー画面 (#menu-screen) へ遷移する。

**アンロック条件:**
- チュートリアル（ステージ0）は常に プレイ可能 であること。
- ステージ1はチュートリアル（ステージ0）クリア後に プレイ可能 になること。
- ステージNはステージN-1クリア後に プレイ可能 になること。

**操作:**
- ロック中 のステージカードはクリックしてもステージ開始しないこと（アラート表示）。
- プレイ可能 または クリア済み のステージカードをクリックすると、対応するステージが開始されること。

#### 4.1.3. ゲームプレイ画面 (#game-screen)

**表示要素:**
- ヘッダーエリア:
  - ステージタイトル（例: 大問1：IPアドレス編）
  - 問題番号（例: 問題1-1）
  - ヒントテキスト（例: あなたは、A子さんに手紙を出したい...郵便局の行き先を指定してね！）
  - 進行度バーとパーセンテージ表示（例: 進行度: 0%）
- ゲームエリア:
  - ネットワークマップ: 問題に応じた建物（郵便局、警察、病院、主人公宅、友人宅など）、パケット君、接続線が表示されること。
  - ドラッグ可能な要素（住所）と、ドロップ可能な要素（パケット君や特定の建物）があること。
  - ping ボタン: 解答送信に使用される。
  - ゲーム注釈（例: 一問目はここの接続だけ）
- 説明エリア:
  - タスク説明（例: 左上の郵便局の住所を左下のパケット君に教えよう）
  - 概念説明（例: pingとは、ネットワーク上で相手のコンピュータに到達できるかを確認するコマンドです。）
- コントロールエリア:
  - メニュー ボタン: ゲームメニューモーダル (#game-menu-modal) を表示する。
  - リセット ボタン: 現在の問題を初期状態に戻す。

**操作:**
- ドラッグ&ドロップ操作: 特定の要素を別の要素にドラッグ&ドロップできること。
- ping ボタン: 解答の条件が満たされた場合にのみ有効化され、クリックで解答が判定されること。

#### 4.1.4. ステージクリア画面 (#stage-clear-screen)

**表示要素:**
- クリアタイトル（例: 🎉 ステージ 1 クリア！ 🎉）
- 学習ポイントパネル: そのステージで学習した内容が箇条書きで分かりやすくまとめられていること。
- ボタン:
  - 次のステージへ ボタン: 次のステージがアンロック済みの場合に表示され、クリックで次のステージ (startStage(currentStage + 1)) へ遷移する。最終ステージクリア時には表示されない。
  - もう一度プレイ ボタン: 現在のステージを最初からプレイし直す。
  - ステージ選択 ボタン: ステージ選択画面 (#stage-select-screen) へ遷移する。
  - メインメニュー ボタン: メインメニュー画面 (#menu-screen) へ遷移する。
- 表示条件: 現在のステージの全問題をクリアした際に表示されること。

#### 4.1.5. 設定画面 (#settings-screen)

**表示要素:**
- 画面タイトル: 設定 が表示されること。
- 音量設定:
  - BGM音量 スライダーと数値表示（0〜100）。
  - 効果音音量 スライダーと数値表示（0〜100）。
- 操作方法:
  - マウス操作、ゲーム操作、ヒントに関するテキスト説明が表示されること。
- メインメニューに戻る ボタン: 設定を保存し、メインメニュー画面 (#menu-screen) へ遷移する。

**機能:**
- スライダーの値を調整すると、音量の状態が一時的に更新されること（音の再生はアルファ版では任意）。
- メインメニューに戻る クリック時に設定値が保存されること。

#### 4.1.6. ゲームメニューモーダル (#game-menu-modal)

**表示要素:**
- タイトル: ゲームメニュー
- ボタン: ステージ選択、メインメニュー、キャンセル
- 表示条件: ゲームプレイ中に メニュー ボタンをクリックした際にオーバーレイ表示されること。

**操作:**
- 各ボタンクリックで対応する画面へ遷移するか、モーダルを閉じること。
- モーダル外をクリックしても閉じられること。

#### 4.1.7. 結果モーダル (#result-modal)

**表示要素:**
- タイトル: 🎉 正解！ または ❌ 不正解 （解答結果に応じる）
- メッセージ: 解答の正否に応じた解説または再挑戦を促すテキスト。
- ボタン:
  - 次の問題 ボタン: 正解時のみ表示され、次の問題へ遷移する。
  - 閉じる ボタン: モーダルを閉じる。
- 表示条件: ping ボタンクリック後の解答判定結果が表示されること。

**操作:**
- 次の問題 または 閉じる ボタンクリック、あるいはモーダル外クリックでモーダルが閉じること。

### 4.2. チュートリアル（ステージ0）機能

#### 4.2.1. 基本操作学習:
- 郵便局の住所（#tutorial-post-office）をパケット君（#tutorial-packet）にドラッグ&ドロップする操作を学ぶ。
- ステップ1: 上の住所をドラッグしてください というナビゲーションメッセージと、郵便局の住所への矢印が表示されること。
- ステップ2: 郵便局の住所をドラッグ開始後、パケット君にドロップしてください というナビゲーションメッセージと、パケット君への矢印が表示されること。
- ステップ3: パケット君に住所をドロップすると、パケット君の表示が 住所なし から 大阪府大阪市夢洲区未来町一丁目 に更新されること。
- ステップ4: チュートリアル完了メッセージ（完了！ステージ1に進みましょう）が表示され、進行度が100%になること。
- 2秒後にチュートリアルクリア画面へ自動遷移すること。

#### 4.2.2. 進行度表示:
- チュートリアルの進行度がプログレスバーとパーセンテージで表示されること。

#### 4.2.3. スキップ機能:
- スキップ ボタンクリックで、チュートリアルを完了済みとしてステージ選択画面へ遷移すること。

### 4.3. ステージ1（IPアドレス編）機能

#### 4.3.1. 問題1-1: シンプルな宛先指定 (problemData.layout === 'simple')

**表示要素:**
- 左上に郵便局（#post-office）、右上に別の郵便局（#post-office-2）の住所が表示される。
- 左下にドロップ可能なパケット君（#packet-kun-left）、右下にドロップ不可のパケット君（#packet-kun-right）が表示される。
- 中央下部に ping ボタンが表示される。

**操作:**
- 左上の郵便局の住所 (#post-office) を、左下のパケット君 (#packet-kun-left) へドラッグ&ドロップで設定できること。
- 設定が完了すると ping ボタンが有効になること。

**判定:**
- ping ボタン押下時、左下のパケット君に post-office の住所が設定されていれば 正解。
- それ以外は 不正解。

#### 4.3.2. 問題1-2: 複雑な経路指定 (problemData.layout === 'complex')

**表示要素:**
- 左上に郵便局（#post-office）、右上に別の郵便局（#post-office-2）の住所が表示される。
- 左下に主人公宅（#hero-address）、右下に友人宅（#friend-address）の住所が表示される。
- パケット君（#packet-kun-right）は右下に配置される。
- 各建物、およびパケット君はドラッグ&ドロップのターゲットになり、割り当てられた住所が表示される assigned-address 要素を持つこと。
- 接続線が問題1-1より複雑に描画されること。

**操作:**
- 特定の住所を別の建物やパケット君にドラッグ&ドロップして割り当てられること。
- 割り当てパターン:
  - #post-office を #packet-kun-right へ割り当てる。
  - #post-office-2 を #post-office へ割り当てる。
  - #friend-address を #post-office-2 へ割り当てる。
- 全ての正しい割り当てが完了すると ping ボタンが有効になること。

**判定:**
- ping ボタン押下時、correctAnswers オブジェクトに定義された全ての割り当てが一致していれば 正解。
- それ以外は 不正解。

#### 4.3.3. 問題1-3: IPアドレスによる経路指定 (problemData.layout === 'ip')

**表示要素:**
- 問題1-2と同様のレイアウトだが、住所がIPアドレス形式（例: 192.168.10.1）で表示されること。
- 対応する要素のIDは ip- プレフィックスが付くこと（例: ip-post-office）。

**操作:**
- IPアドレス形式の住所をドラッグ&ドロップで割り当てられること。
- 割り当てパターン:
  - #ip-post-office を #ip-packet-kun-right へ割り当てる。
  - #ip-post-office-2 を #ip-post-office へ割り当てる。
  - #ip-friend-address を #ip-post-office-2 へ割り当てる。
- 全ての正しい割り当てが完了すると ping ボタンが有効になること。

**判定:**
- ping ボタン押下時、correctAnswers オブジェクトに定義された全ての割り当てが一致していれば 正解。
- それ以外は 不正解。

## 5. 非機能要件
ゲームの品質や運用に関する技術的な側面です。

### 5.1. パフォーマンス:
- 主要なモダンブラウザ（Chrome, Firefox, Safari, Edge の最新バージョン）で、読み込み時間3秒以内、フレームレート30fps以上を維持してスムーズに動作すること。
- 特にドラッグ&ドロップ中の描画やアニメーションが滑らかであること。

### 5.2. ユーザビリティ:
- 各要素のクリック可能/ドラッグ可能領域が十分に確保されており、誤操作が起こりにくいこと。
- ドラッグ時に、ドロップ可能なターゲット要素が視覚的に（例: 枠線の色変更、背景色の変化）ハイライトされること。
- ドラッグ&ドロップの開始・終了時に、dragging および drop-target クラスが適切に付与・削除され、視覚的なフィードバックがあること。
- ヒント、問題文、説明文は、ユーザーが理解しやすい平易な日本語で記述されていること。

### 5.3. デザイン:
- [styles.css] に定義されたデザインガイドラインに沿っており、全体を通して一貫性のある見た目であること。
- 色使いは学習コンテンツとして適切であり、目に優しく、主要な情報が際立つ配色であること。
- レスポンシブデザインに対応し、画面幅320px〜1920pxの範囲でレイアウトが崩れず、各要素が適切にリサイズ・再配置されること。特にモバイルデバイスでの操作性も考慮すること。

### 5.4. 保守性:
- JavaScriptコードはES6+の記法に従い、クラスベース（NetworkGameクラス、GameStateクラスなど）でモジュール化されていること。
- HTML、CSS、JavaScriptファイルは責務が明確に分離されており、相互依存性が低い設計であること。
- ステージや問題のデータは、JavaScriptファイル内で構造化されたオブジェクトとして管理されており、追加・変更が容易であること。

### 5.5. 拡張性:
- 新たなステージや問題を追加する際に、既存のコードに大幅な変更を加える必要がないような設計になっていること。
- 将来的にサウンドやアニメーションを追加する際に、容易に組み込めるようなインターフェースが考慮されていること（例: 音量設定機能の準備）。

### 5.6. 永続性:
- ユーザーのステージクリア状況 (gameState.completedStages) と、設定 (soundVolume, effectVolume) は、ブラウザの localStorage を使用して保存され、ゲームを終了しても次回アクセス時に状態が復元されること。

## 6. 技術スタック
### フロントエンド:
- HTML5
- CSS3
- JavaScript (ES6+)

### バージョン管理:
- Git / GitHub